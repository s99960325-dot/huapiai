import{d as z,x as L,c as P,a as l,w as t,k as d,E as u,r as i,o as I,h as r,i as a,v as q,q as A,_ as D}from"./index-cIS50Myt.js";import{b as T,c as W,u as j,d as F,r as G}from"./system-COZ-n8x3.js";const H={class:"system-view"},J={class:"card-header"},K={class:"action-list"},O={class:"action-item"},Q={class:"action-item"},R={class:"action-item"},X={class:"log-container"},Y={class:"logs"},Z=z({__name:"SystemView",setup(h){const V=d(!1),f=d(!1),_=d(!1),y=d(!1),g=d(!1),w=d(""),o=d({web:{host:"127.0.0.1",port:8080},system:{timezone:"Asia/Shanghai"},update:{pypi_registry:"",npm_registry:""}}),k=async()=>{V.value=!0;try{const n=await T();o.value=n}catch{u.error("加载配置失败")}finally{V.value=!1}},x=async()=>{f.value=!0;try{await j(o.value),u.success("保存成功")}catch{u.error("保存失败")}finally{f.value=!1}},S=async()=>{_.value=!0;try{const n=await F();n.has_update?u.warning(`发现新版本: ${n.latest_version}`):u.success("当前已是最新版本")}catch{u.error("检查失败")}finally{_.value=!1}},U=async()=>{try{await A.confirm("确定要重启系统吗？","提示",{type:"warning"}),y.value=!0,await G(),u.success("系统正在重启...")}catch{}finally{y.value=!1}},B=async()=>{try{const n=await W();w.value=n.logs||"暂无日志"}catch{w.value="加载日志失败"}};return L(()=>{k(),B()}),(n,e)=>{const c=i("el-button"),m=i("el-divider"),v=i("el-input"),p=i("el-form-item"),E=i("el-input-number"),M=i("el-form"),b=i("el-card"),C=i("el-col"),N=i("el-row"),$=i("el-dialog");return I(),P("div",H,[l(N,{gutter:20},{default:t(()=>[l(C,{span:12},{default:t(()=>[l(b,null,{header:t(()=>[a("div",J,[e[8]||(e[8]=a("span",null,"系统配置",-1)),l(c,{type:"primary",onClick:x,loading:f.value},{default:t(()=>[...e[7]||(e[7]=[r("保存",-1)])]),_:1},8,["loading"])])]),default:t(()=>[l(M,{model:o.value,"label-width":"150px"},{default:t(()=>[l(m,null,{default:t(()=>[...e[9]||(e[9]=[r("Web服务",-1)])]),_:1}),l(p,{label:"监听地址"},{default:t(()=>[l(v,{modelValue:o.value.web.host,"onUpdate:modelValue":e[0]||(e[0]=s=>o.value.web.host=s)},null,8,["modelValue"])]),_:1}),l(p,{label:"端口"},{default:t(()=>[l(E,{modelValue:o.value.web.port,"onUpdate:modelValue":e[1]||(e[1]=s=>o.value.web.port=s),min:1,max:65535},null,8,["modelValue"])]),_:1}),l(m,null,{default:t(()=>[...e[10]||(e[10]=[r("系统设置",-1)])]),_:1}),l(p,{label:"时区"},{default:t(()=>[l(v,{modelValue:o.value.system.timezone,"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.system.timezone=s)},null,8,["modelValue"])]),_:1}),l(m,null,{default:t(()=>[...e[11]||(e[11]=[r("更新配置",-1)])]),_:1}),l(p,{label:"PyPI镜像"},{default:t(()=>[l(v,{modelValue:o.value.update.pypi_registry,"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.update.pypi_registry=s)},null,8,["modelValue"])]),_:1}),l(p,{label:"NPM镜像"},{default:t(()=>[l(v,{modelValue:o.value.update.npm_registry,"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.update.npm_registry=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),l(C,{span:12},{default:t(()=>[l(b,null,{header:t(()=>[...e[12]||(e[12]=[a("div",{class:"card-header"},[a("span",null,"系统操作")],-1)])]),default:t(()=>[a("div",K,[a("div",O,[e[14]||(e[14]=a("div",{class:"action-info"},[a("div",{class:"action-title"},"检查更新"),a("div",{class:"action-desc"},"检查系统是否有新版本可用")],-1)),l(c,{type:"primary",onClick:S,loading:_.value},{default:t(()=>[...e[13]||(e[13]=[r("检查",-1)])]),_:1},8,["loading"])]),l(m),a("div",Q,[e[16]||(e[16]=a("div",{class:"action-info"},[a("div",{class:"action-title"},"重启系统"),a("div",{class:"action-desc"},"重启整个应用程序")],-1)),l(c,{type:"warning",onClick:U,loading:y.value},{default:t(()=>[...e[15]||(e[15]=[r("重启",-1)])]),_:1},8,["loading"])]),l(m),a("div",R,[e[18]||(e[18]=a("div",{class:"action-info"},[a("div",{class:"action-title"},"查看日志"),a("div",{class:"action-desc"},"实时查看系统运行日志")],-1)),l(c,{onClick:e[5]||(e[5]=s=>g.value=!0)},{default:t(()=>[...e[17]||(e[17]=[r("查看",-1)])]),_:1})])])]),_:1})]),_:1})]),_:1}),l($,{modelValue:g.value,"onUpdate:modelValue":e[6]||(e[6]=s=>g.value=s),title:"系统日志",width:"800px",fullscreen:""},{default:t(()=>[a("div",X,[a("pre",Y,q(w.value),1)])]),_:1},8,["modelValue"])])}}}),te=D(Z,[["__scopeId","data-v-74850720"]]);export{te as default};
