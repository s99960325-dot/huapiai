import{d as k,u as E,o as C,c as x,i as B,p as $,q as w,w as n,e as a,s as D,r as m,E as i,v as T,h as _,a as l,x as r,H as V,n as p,t as b,m as h,y as M}from"./index-e4srcsQT.js";const q=k({__name:"DispatchRulesView",setup(N){const c=E(),f=m([]),o=m(!1);async function d(){o.value=!0;try{const e=await c.client.get("/api/dispatch/rules");f.value=e.rules||[]}catch(e){i.error(e.message)}finally{o.value=!1}}async function y(e){const t=e.enabled?"disable":"enable";try{await c.client.post(`/api/dispatch/rules/${e.rule_id}/${t}`),i.success(e.enabled?"已禁用":"已启用"),d()}catch(u){i.error(u.message)}}async function g(e){await M.confirm(`确定删除规则「${e.name??e.rule_id}」？`);try{await c.client.delete(`/api/dispatch/rules/${e.rule_id}`),i.success("已删除"),d()}catch(t){i.error(t.message)}}return C(d),(e,t)=>{const u=T("loading");return _(),x("div",null,[t[1]||(t[1]=B("h3",null,"调度规则",-1)),$((_(),w(a(D),{data:f.value,stripe:""},{default:n(()=>[l(a(r),{prop:"rule_id",label:"ID",width:"120"}),l(a(r),{prop:"name",label:"名称"}),l(a(r),{prop:"priority",label:"优先级",width:"80"}),l(a(r),{label:"状态",width:"100"},{default:n(({row:s})=>[l(a(V),{type:s.enabled?"success":"info"},{default:n(()=>[p(b(s.enabled?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),l(a(r),{label:"操作",width:"180"},{default:n(({row:s})=>[l(a(h),{link:"",type:"primary",onClick:v=>y(s)},{default:n(()=>[p(b(s.enabled?"禁用":"启用"),1)]),_:2},1032,["onClick"]),l(a(h),{link:"",type:"danger",onClick:v=>g(s)},{default:n(()=>[...t[0]||(t[0]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[u,o.value]])])}}});export{q as default};
