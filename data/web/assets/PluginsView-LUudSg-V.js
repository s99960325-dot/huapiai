import{d as w,u as $,o as x,c as B,i as V,p as N,q as o,w as l,e as a,s as T,r as b,E as s,v as h,h as i,a as u,x as r,H as g,n as d,t as D,m,j as M,y as S}from"./index-e4srcsQT.js";const A=w({__name:"PluginsView",setup(j){const p=$(),y=b([]),f=b(!1);async function c(){f.value=!0;try{const t=await p.client.get("/api/plugin/plugins");y.value=t.plugins||[]}catch(t){s.error(t.message)}finally{f.value=!1}}async function v(t){try{await p.client.post(`/api/plugin/plugins/${t.name}/enable`),s.success("已启用"),c()}catch(e){s.error(e.message)}}async function _(t){try{await p.client.post(`/api/plugin/plugins/${t.name}/disable`),s.success("已禁用"),c()}catch(e){s.error(e.message)}}async function C(t){if(t.is_internal){s.warning("内置插件不可卸载");return}await S.confirm(`确定卸载「${t.name}」？`);try{await p.client.delete(`/api/plugin/plugins/${t.name}`),s.success("已卸载"),c()}catch(e){s.error(e.message)}}return x(c),(t,e)=>{const E=h("loading");return i(),B("div",null,[e[5]||(e[5]=V("h3",null,"已安装插件",-1)),N((i(),o(a(T),{data:y.value,stripe:""},{default:l(()=>[u(a(r),{prop:"name",label:"名称"}),u(a(r),{prop:"package_name",label:"包名"}),u(a(r),{prop:"version",label:"版本",width:"100"}),u(a(r),{label:"类型",width:"80"},{default:l(({row:n})=>[n.is_internal?(i(),o(a(g),{key:0,type:"info"},{default:l(()=>[...e[0]||(e[0]=[d("内置",-1)])]),_:1})):(i(),o(a(g),{key:1},{default:l(()=>[...e[1]||(e[1]=[d("外部",-1)])]),_:1}))]),_:1}),u(a(r),{label:"状态",width:"100"},{default:l(({row:n})=>[u(a(g),{type:n.is_enabled?"success":"info"},{default:l(()=>[d(D(n.is_enabled?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),u(a(r),{label:"操作",width:"220"},{default:l(({row:n})=>[n.is_enabled?(i(),o(a(m),{key:1,link:"",onClick:k=>_(n)},{default:l(()=>[...e[3]||(e[3]=[d("禁用",-1)])]),_:1},8,["onClick"])):(i(),o(a(m),{key:0,link:"",type:"primary",onClick:k=>v(n)},{default:l(()=>[...e[2]||(e[2]=[d("启用",-1)])]),_:1},8,["onClick"])),n.is_internal?M("",!0):(i(),o(a(m),{key:2,link:"",type:"danger",onClick:k=>C(n)},{default:l(()=>[...e[4]||(e[4]=[d("卸载",-1)])]),_:1},8,["onClick"]))]),_:1})]),_:1},8,["data"])),[[E,f.value]])])}}});export{A as default};
